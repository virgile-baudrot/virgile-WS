---
title: Personnal coding rules in R
author: Virgile
date: '2017-08-24'
slug: personnal-coding-rules-in-r
categories:
  - R
tags:
  - R
  - code
editor_options:
  chunk_output_type: console
---



<p><em>Note: the following post is supposed to be updated regularly</em></p>
<div id="style-guides" class="section level2">
<h2>Style guides</h2>
<p>Some references are unavoidable, the <a href="http://adv-r.had.co.nz/Style.html">Hadley’s style guide</a>, the <a href="https://google.github.io/styleguide/Rguide.xml">Google’s R style guide</a>, and also <a href="http://www.burns-stat.com/pages/Tutor/R_inferno.pdf"><em>The R Inferno</em> by Patrick Burns</a></p>
<p>As Hadley wrote, the most important is to have <em>a consistent and clear style</em>.</p>
</div>
<div id="notations" class="section level2">
<h2>Notations</h2>
<p>Starting with variable, choices doesn’t really matters.</p>
<p>I use this style of notation:</p>
<pre class="r"><code># GOOD
variableName # camelCasing style
variable_Name

# Not that good (personnal taste)
variable.Name

# BAD
variablename</code></pre>
<p>I like the <em>camelCasing</em> when the capital letters look like the humps on a camel’s back (e.g. <code>camelBack</code>).</p>
<p>I also like to write the name of the variable in first and then it’s specification:</p>
<pre class="r"><code># GOOD
kk = 1:5
kk_max = max(kk)
kk_sd = sd(kk)
kk_log10Mean = log10(mean(kk))

# BAD (personnal taste)
max_kk = max(kk)
sd_kk = sd(kk)
log10Mean_kk = log10(mean(kk))</code></pre>
<p>So then, variables have the follwing look:</p>
<pre class="r"><code># GOOD
frenchMen_weight &lt;- c(80, 84, 74)
frenchMen_size &lt;- c(180, 175, 176)
frenchWomen_weight &lt;- c(NA, 75, 65)
frenchWomen_size &lt;- c(160, 177, 167)

frenchMen_sizeMean &lt;- mean(frenchMen_size)
frenchMen_sizeSD &lt;- sd(frenchMen_size)</code></pre>
</div>
<div id="dont-do" class="section level2">
<h2>Don’t do</h2>
<p>Some letters are use in <code>R</code>, like <code>T</code> which is used for the boolean <code>TRUE</code>, therefore, do not use as variable:</p>
<pre class="r"><code># BAD
T
F
TRUE
FALSE

# GOOD
Temperature ; Total
Fox ; Flower</code></pre>
<div id="name-of-functions" class="section level3">
<h3>name of functions</h3>
<p>I do not have a definitive point of view for naming function. Of course, I do not use name already used:</p>
<pre class="r"><code># BAD
c() # vector
lm() # linear model</code></pre>
<p>And I use S3 dispatch when necessary, with the <strong>generic functions</strong> <code>plot.myClass</code>, <code>print.myClass</code>, <code>summary.myClass</code>, …</p>
<p>Look at the difference for Figures <a href="#fig:withoutS3plot"><strong>??</strong></a> and See Figure <a href="#fig:withS3plot">1</a></p>
<pre class="r"><code>a &lt;- data.frame(col1 = 1:10, col2 = 1:10)

plot(a)</code></pre>
<p><img src="/post/2017-08-24-personnal-coding-rules-in-r_files/figure-html/withoutS3plot-1.png" width="672" /></p>
<pre class="r"><code>class(a) &lt;- &quot;myClass&quot;

plot.myClass = function(x) plot(x[[1]] ~ x[[2]], type = &quot;l&quot;)

plot(a)</code></pre>
<div class="figure"><span id="fig:withS3plot"></span>
<img src="/post/2017-08-24-personnal-coding-rules-in-r_files/figure-html/withS3plot-1.png" alt="Result of S3 dispatch on class myClass." width="672" />
<p class="caption">
Figure 1: Result of S3 dispatch on class myClass.
</p>
</div>
</div>
<div id="assignement-operator---or" class="section level3">
<h3>Assignement operator: <code>&lt;-</code> or <code>=</code></h3>
<p>Big question in R: <a href="http://blog.revolutionanalytics.com/2008/12/use-equals-or-arrow-for-assignment.html">revolutionanalytics?</a> <a href="http://stackoverflow.com/questions/1741820/assignment-operators-in-r-and">stackoverflow</a></p>
<p>Following the answer on <a href="https://stackoverflow.com/questions/1741820/assignment-operators-in-r-and">stackoverflow</a> by <a href="https://stackoverflow.com/users/134830/richie-cotton">Richie Cotton</a>, lets</p>
<p>Let’s take this function: <code>median(x, na.rm = FALSE, ...)</code>, and look at all of these codes:</p>
<pre class="r"><code>median(x &lt;- 1:10)
median(x = 1:10)

# but:
median(a &lt;- 1:10)
median(a = 1:10)

# and also:
b
median(b &lt;- 1:10)
b</code></pre>
<p>Another thing to test to understand difference between <code>=</code> and <code>&lt;-</code></p>
<pre class="r"><code>a &lt;- b = 5
a = b = 5 ; a ; b
a = 5 = b
6 -&gt; c ; c
c &lt;- 6 -&gt; d ; c ; d</code></pre>
<p>When you create a <code>data.frame</code>, or a <code>list</code>, you have to use <code>=</code> inside, while <code>&lt;-</code> does not return an error:</p>
<pre class="r"><code>myDf1 &lt;- data.frame(e &lt;- 6) ; myDf1</code></pre>
<pre><code>##   e....6
## 1      6</code></pre>
<pre class="r"><code>myDf2 &lt;- data.frame(e = 6) ; myDf2</code></pre>
<pre><code>##   e
## 1 6</code></pre>
<pre class="r"><code>myList1 &lt;- list(e &lt;- 6) ; myList1</code></pre>
<pre><code>## [[1]]
## [1] 6</code></pre>
<pre class="r"><code>myList2 &lt;- list(e = 6) ; myList2</code></pre>
<pre><code>## $e
## [1] 6</code></pre>
<p>Finally, just use <strong>space</strong> in a write way to avoid the following mistake:</p>
<pre class="r"><code>a &lt;- 3
a&lt; -3</code></pre>
<pre><code>## [1] FALSE</code></pre>
<p>Finally, I use <code>&lt;-</code> operator for assignement, and <code>=</code> inside functions.</p>
</div>
<div id="spacing" class="section level3">
<h3>Spacing</h3>
<p>Spacing is used to have a clear code. * Spaces around assignements: <code>a = b</code>, <code>a &lt;- b</code> * A space after a coma: <code>myMatrix[2, 2]</code> * No space in brackets: <code>c(1, 4, 9)</code> * Change of line every 80 characters * Change of line when repetting an assignement</p>
<pre class="r"><code># GOOD
myList &lt;- list(a = 1,
               b = &quot;fourchette&quot;,
               c = letters[1:10],
               d = 1:10,
               e = matrix(1:9, ncol=3),
               f = &quot;couteau&quot;,
               g = &quot;chocolat&quot;)

myList[[5]][2, 2]</code></pre>
<pre><code>## [1] 5</code></pre>
<pre class="r"><code>## GOOD but, I would put this long text in a separate file, and then load it
text_Miserable_Review &lt;- &quot;Tant qu’il existera, par le fait des lois et des
moeurs, une damnation sociale créant artificiellement, en pleine civilisation,
des enfers, et compliquant d’une fatalité humaine la destinée qui est divine ;
tant que les trois problèmes du siècle, la dégradation de l’homme par le
prolétariat, la déchéance de la femme par la faim, l’atrophie de l’enfant par
la nuit, ne seront pas résolus ; tant que, dans de certaines régions,
l’asphyxie sociale sera possible ; en d’autres termes, et à un point de vue
plus étendu encore, tant qu’il y aura sur la terre ignorance et misère, des
livres de la nature de celui-ci pourront ne pas être inutiles.&quot;

# BAD
myList &lt;- list(a = 1, b = &quot;fourchette&quot;, c = letters[1:10], d = 1:10, e = matrix(1:9, ncol=3), f = &quot;couteau&quot;, g = &quot;chocolat&quot;)

text_Miserable_Review &lt;- &quot;Tant qu’il existera, par le fait des lois et des moeurs, une damnation sociale créant artificiellement, en pleine civilisation, des enfers, et compliquant d’une fatalité humaine la destinée qui est divine ; tant que les trois problèmes du siècle, la dégradation de l’homme par le prolétariat, la déchéance de la femme par la faim, l’atrophie de l’enfant par la nuit, ne seront pas résolus ; tant que, dans de certaines régions, l’asphyxie sociale sera possible ; en d’autres termes, et à un point de vue plus étendu encore, tant qu’il y aura sur la terre ignorance et misère, des livres de la nature de celui-ci pourront ne pas être inutiles.&quot;

# Very BAD
myList&lt;-list(a=1,b=&quot;fourchette&quot;,c=letters[1:10],d=1:10,e=matrix(1:9,ncol=3),f=&quot;couteau&quot;,g=&quot;chocolat&quot;)</code></pre>
</div>
<div id="ifelse-what-else" class="section level3">
<h3><code>ifelse</code> what else</h3>
<pre class="r"><code># GOOD
if (y == 0) {
  log(x)
} else {
  y ^ x
}

# GOOD if less than 80 characters
if (y == 0) log(x)

# GOOD also
if (y == 0) {
  log(x)
} else stop(&quot;error message&quot;)</code></pre>
</div>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<ul>
<li>Deprecated: <code>deprecate()</code></li>
<li>Errors: <code>stop()</code></li>
<li>Warnings: <code>warning()</code></li>
<li>Return: <code>return()</code></li>
</ul>
</div>
<div id="boolean" class="section level2">
<h2>Boolean</h2>
<p><a href="http://stackoverflow.com/questions/6558921/r-boolean-operators-and">From this answer in stackexchange</a></p>
<p>Difference between <code>&amp;</code> and <code>&amp;&amp;</code></p>
<pre class="r"><code>((-2:2) &gt;= 0) &amp; ((-2:2) &lt;= 0)</code></pre>
<pre><code>## [1] FALSE FALSE  TRUE FALSE FALSE</code></pre>
<pre class="r"><code>((-2:2) &gt;= 0) &amp;&amp; ((-2:2) &lt;= 0)</code></pre>
<pre><code>## [1] FALSE</code></pre>
<p>Difference between <code>|</code> and <code>||</code></p>
<pre class="r"><code>((-5:-1) &gt;= 0) | ((-2:2) &lt;= 0)</code></pre>
<pre><code>## [1]  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
<pre class="r"><code>((-5:-1) &gt;= 0) || ((-2:2) &lt;= 0)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>a
# Erreur : objet &#39;a&#39; introuvable
TRUE || a
# [1] TRUE
FALSE &amp;&amp; a
# [1] FALSE
TRUE | a
# Erreur : objet &#39;a&#39; introuvable
FALSE &amp; a
# Erreur : objet &#39;a&#39; introuvable</code></pre>
</div>
